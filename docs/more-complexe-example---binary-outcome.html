<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 More complexe example - binary outcome | MAIDHA | Very detailed examples</title>
  <meta name="description" content="<p>This is a very detailed example of using the MAIDHA approach to describe
intersectional phenomenon in biology and health.</p>" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="5 More complexe example - binary outcome | MAIDHA | Very detailed examples" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a very detailed example of using the MAIDHA approach to describe
intersectional phenomenon in biology and health.</p>" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 More complexe example - binary outcome | MAIDHA | Very detailed examples" />
  
  <meta name="twitter:description" content="<p>This is a very detailed example of using the MAIDHA approach to describe
intersectional phenomenon in biology and health.</p>" />
  

<meta name="author" content="H. Colineaux" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simple-example---continous-outcome.html"/>
<link rel="next" href="more-complexe-example---quantitative-outcome.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/table1-1.0/table1_defaults.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="create-stratas.html"><a href="create-stratas.html"><i class="fa fa-check"></i><b>2</b> Create stratas</a>
<ul>
<li class="chapter" data-level="2.1" data-path="create-stratas.html"><a href="create-stratas.html#choose-variables"><i class="fa fa-check"></i><b>2.1</b> Choose variables</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="create-stratas.html"><a href="create-stratas.html#a-first-simple-exemple-12-strata"><i class="fa fa-check"></i><b>2.1.1</b> A first simple exemple (12 strata)</a></li>
<li class="chapter" data-level="2.1.2" data-path="create-stratas.html"><a href="create-stratas.html#a-second-exemple-48-strata"><i class="fa fa-check"></i><b>2.1.2</b> A second exemple (48 strata)</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="create-stratas.html"><a href="create-stratas.html#definition-and-description"><i class="fa fa-check"></i><b>2.2</b> Definition and description</a></li>
<li class="chapter" data-level="2.3" data-path="create-stratas.html"><a href="create-stratas.html#create-strata-variables"><i class="fa fa-check"></i><b>2.3</b> Create strata variables</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="create-stratas.html"><a href="create-stratas.html#for-the-first-exemple-12-strata"><i class="fa fa-check"></i><b>2.3.1</b> For the first exemple (12 strata)</a></li>
<li class="chapter" data-level="2.3.2" data-path="create-stratas.html"><a href="create-stratas.html#for-the-second-exemple-48-strata"><i class="fa fa-check"></i><b>2.3.2</b> For the second exemple (48 strata)</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="create-stratas.html"><a href="create-stratas.html#plots-the-stratas-distribution"><i class="fa fa-check"></i><b>2.4</b> Plots the stratas distribution</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="create-stratas.html"><a href="create-stratas.html#for-the-first-exemple"><i class="fa fa-check"></i><b>2.4.1</b> For the first exemple</a></li>
<li class="chapter" data-level="2.4.2" data-path="create-stratas.html"><a href="create-stratas.html#for-the-second-exemple"><i class="fa fa-check"></i><b>2.4.2</b> For the second exemple</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simple-example---binary-outcome.html"><a href="simple-example---binary-outcome.html"><i class="fa fa-check"></i><b>3</b> Simple example - binary outcome</a>
<ul>
<li class="chapter" data-level="3.1" data-path="simple-example---binary-outcome.html"><a href="simple-example---binary-outcome.html#description"><i class="fa fa-check"></i><b>3.1</b> Description</a></li>
<li class="chapter" data-level="3.2" data-path="simple-example---binary-outcome.html"><a href="simple-example---binary-outcome.html#the-null-model-only-strata"><i class="fa fa-check"></i><b>3.2</b> The null model (only strata)</a></li>
<li class="chapter" data-level="3.3" data-path="simple-example---binary-outcome.html"><a href="simple-example---binary-outcome.html#the-variance-change"><i class="fa fa-check"></i><b>3.3</b> The variance change</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simple-example---continous-outcome.html"><a href="simple-example---continous-outcome.html"><i class="fa fa-check"></i><b>4</b> Simple example - continous outcome</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simple-example---continous-outcome.html"><a href="simple-example---continous-outcome.html#description-1"><i class="fa fa-check"></i><b>4.1</b> Description</a></li>
<li class="chapter" data-level="4.2" data-path="simple-example---continous-outcome.html"><a href="simple-example---continous-outcome.html#the-null-model-only-strata-1"><i class="fa fa-check"></i><b>4.2</b> The null model (only strata)</a></li>
<li class="chapter" data-level="4.3" data-path="simple-example---continous-outcome.html"><a href="simple-example---continous-outcome.html#the-variance-change-1"><i class="fa fa-check"></i><b>4.3</b> The variance change</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="more-complexe-example---binary-outcome.html"><a href="more-complexe-example---binary-outcome.html"><i class="fa fa-check"></i><b>5</b> More complexe example - binary outcome</a>
<ul>
<li class="chapter" data-level="5.1" data-path="more-complexe-example---binary-outcome.html"><a href="more-complexe-example---binary-outcome.html#description-2"><i class="fa fa-check"></i><b>5.1</b> Description</a></li>
<li class="chapter" data-level="5.2" data-path="more-complexe-example---binary-outcome.html"><a href="more-complexe-example---binary-outcome.html#the-null-model-only-strata-2"><i class="fa fa-check"></i><b>5.2</b> The null model (only strata)</a></li>
<li class="chapter" data-level="5.3" data-path="more-complexe-example---binary-outcome.html"><a href="more-complexe-example---binary-outcome.html#the-variance-change-2"><i class="fa fa-check"></i><b>5.3</b> The variance change</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="more-complexe-example---quantitative-outcome.html"><a href="more-complexe-example---quantitative-outcome.html"><i class="fa fa-check"></i><b>6</b> More complexe example - quantitative outcome</a>
<ul>
<li class="chapter" data-level="6.1" data-path="more-complexe-example---quantitative-outcome.html"><a href="more-complexe-example---quantitative-outcome.html#description-3"><i class="fa fa-check"></i><b>6.1</b> Description</a></li>
<li class="chapter" data-level="6.2" data-path="more-complexe-example---quantitative-outcome.html"><a href="more-complexe-example---quantitative-outcome.html#the-null-model-only-strata-3"><i class="fa fa-check"></i><b>6.2</b> The null model (only strata)</a></li>
<li class="chapter" data-level="6.3" data-path="more-complexe-example---quantitative-outcome.html"><a href="more-complexe-example---quantitative-outcome.html#the-variance-change-3"><i class="fa fa-check"></i><b>6.3</b> The variance change</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MAIDHA | Very detailed examples</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="more-complexe-example---binary-outcome" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> More complexe example - binary outcome<a href="more-complexe-example---binary-outcome.html#more-complexe-example---binary-outcome" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>As a working example, we want to explore intersectional inequalities in exposition to air pollution (pm 10) by intersectional strata (48 stratas).</p>
<div id="description-2" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Description<a href="more-complexe-example---binary-outcome.html#description-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can start by describe the outcome by strata.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="more-complexe-example---binary-outcome.html#cb45-1" aria-hidden="true" tabindex="-1"></a>table1<span class="sc">::</span><span class="fu">table1</span>(<span class="sc">~</span> Sex <span class="sc">+</span> Age_class <span class="sc">+</span> Ethnicity <span class="sc">+</span></span>
<span id="cb45-2"><a href="more-complexe-example---binary-outcome.html#cb45-2" aria-hidden="true" tabindex="-1"></a>                 Education <span class="sc">+</span> Urban <span class="sc">|</span> AlcDaily,</span>
<span id="cb45-3"><a href="more-complexe-example---binary-outcome.html#cb45-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">data=</span>mydata,</span>
<span id="cb45-4"><a href="more-complexe-example---binary-outcome.html#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">overall=</span><span class="fu">c</span>(<span class="at">left=</span><span class="st">&quot;Total&quot;</span>),</span>
<span id="cb45-5"><a href="more-complexe-example---binary-outcome.html#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption=</span><span class="st">&quot;Description by Alcohol consumption&quot;</span>)</span></code></pre></div>
<div class="Rtable1"><table class="Rtable1"><caption>Description by Alcohol consumption</caption>

<thead>
<tr>
<th class='rowlabel firstrow lastrow'></th>
<th class='firstrow lastrow'><span class='stratlabel'>Total<br><span class='stratn'>(N=502461)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>No<br><span class='stratn'>(N=400687)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>Yes<br><span class='stratn'>(N=101774)</span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td class='rowlabel firstrow'>Sex</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Women</td>
<td>273354 (54.4%)</td>
<td>229491 (57.3%)</td>
<td>43863 (43.1%)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Men</td>
<td class='lastrow'>229107 (45.6%)</td>
<td class='lastrow'>171196 (42.7%)</td>
<td class='lastrow'>57911 (56.9%)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>Age_class</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>-50</td>
<td>132145 (26.3%)</td>
<td>111893 (27.9%)</td>
<td>20252 (19.9%)</td>
</tr>
<tr>
<td class='rowlabel'>51-60</td>
<td>177222 (35.3%)</td>
<td>140862 (35.2%)</td>
<td>36360 (35.7%)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>61+</td>
<td class='lastrow'>193094 (38.4%)</td>
<td class='lastrow'>147932 (36.9%)</td>
<td class='lastrow'>45162 (44.4%)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>Ethnicity</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Non White</td>
<td>27037 (5.4%)</td>
<td>24979 (6.2%)</td>
<td>2058 (2.0%)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>White</td>
<td class='lastrow'>475424 (94.6%)</td>
<td class='lastrow'>375708 (93.8%)</td>
<td class='lastrow'>99716 (98.0%)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>Education</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Short Educ.</td>
<td>284626 (56.6%)</td>
<td>231583 (57.8%)</td>
<td>53043 (52.1%)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Long Educ.</td>
<td class='lastrow'>217835 (43.4%)</td>
<td class='lastrow'>169104 (42.2%)</td>
<td class='lastrow'>48731 (47.9%)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>Urban</td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Rural</td>
<td>68955 (13.7%)</td>
<td>51738 (12.9%)</td>
<td>17217 (16.9%)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Urban</td>
<td class='lastrow'>433506 (86.3%)</td>
<td class='lastrow'>348949 (87.1%)</td>
<td class='lastrow'>84557 (83.1%)</td>
</tr>
</tbody>
</table>
</div>
<p>We can plot the observed probability.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="more-complexe-example---binary-outcome.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="st">&quot;img/plot_12_quali_2.jpeg&quot;</span>,</span>
<span id="cb46-2"><a href="more-complexe-example---binary-outcome.html#cb46-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="st">&quot;500&quot;</span>)</span>
<span id="cb46-3"><a href="more-complexe-example---binary-outcome.html#cb46-3" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="more-complexe-example---binary-outcome.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(strata_2) <span class="sc">%&gt;%</span> </span>
<span id="cb46-5"><a href="more-complexe-example---binary-outcome.html#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tot =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb46-6"><a href="more-complexe-example---binary-outcome.html#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(strata_2,AlcDaily) <span class="sc">%&gt;%</span> </span>
<span id="cb46-7"><a href="more-complexe-example---binary-outcome.html#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">n</span>()<span class="sc">/</span>tot) <span class="sc">%&gt;%</span> </span>
<span id="cb46-8"><a href="more-complexe-example---binary-outcome.html#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AlcDaily <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-9"><a href="more-complexe-example---binary-outcome.html#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(strata_2,value,<span class="at">.fun=</span><span class="st">&#39;median&#39;</span>),</span>
<span id="cb46-10"><a href="more-complexe-example---binary-outcome.html#cb46-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span>value)) <span class="sc">+</span></span>
<span id="cb46-11"><a href="more-complexe-example---binary-outcome.html#cb46-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()  <span class="sc">+</span></span>
<span id="cb46-12"><a href="more-complexe-example---binary-outcome.html#cb46-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Stratas&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Daily alcohol consumption&quot;</span>,</span>
<span id="cb46-13"><a href="more-complexe-example---binary-outcome.html#cb46-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;Observed percentage by stratas&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-14"><a href="more-complexe-example---binary-outcome.html#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,  <span class="at">vjust=</span><span class="dv">1</span>,  <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb46-15"><a href="more-complexe-example---binary-outcome.html#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>## png 
##   2</code></pre>
<p><img src="img/plot_12_quali_2.jpeg" /></p>
</div>
<div id="the-null-model-only-strata-2" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> The null model (only strata)<a href="more-complexe-example---binary-outcome.html#the-null-model-only-strata-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The null model allows us to estimate the IntraClass correlation (ICC), also known as the Variance Partition Coefficient (VPC), that is the part of the outcome variance that can be explained by the strata.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="more-complexe-example---binary-outcome.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multilevel model</span></span>
<span id="cb48-2"><a href="more-complexe-example---binary-outcome.html#cb48-2" aria-hidden="true" tabindex="-1"></a>m_null <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(AlcDaily <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> strata_2),</span>
<span id="cb48-3"><a href="more-complexe-example---binary-outcome.html#cb48-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> mydata,</span>
<span id="cb48-4"><a href="more-complexe-example---binary-outcome.html#cb48-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> binomial)</span>
<span id="cb48-5"><a href="more-complexe-example---binary-outcome.html#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="more-complexe-example---binary-outcome.html#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># intercept varies according to the stratum</span></span>
<span id="cb48-7"><a href="more-complexe-example---binary-outcome.html#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="st">&quot;img/models_1_2.jpeg&quot;</span>,</span>
<span id="cb48-8"><a href="more-complexe-example---binary-outcome.html#cb48-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="st">&quot;500&quot;</span>)</span>
<span id="cb48-9"><a href="more-complexe-example---binary-outcome.html#cb48-9" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(m_null, <span class="at">type =</span> <span class="st">&quot;diag&quot;</span>)</span></code></pre></div>
<pre><code>## $strata_2</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="more-complexe-example---binary-outcome.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>## png 
##   2</code></pre>
<p><img src="img/models_1_2.jpeg" /></p>
<p>Outputs of the models:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="more-complexe-example---binary-outcome.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_null)</span></code></pre></div>
<pre><code>##  Family: binomial  ( logit )
## Formula:          AlcDaily ~ 1 + (1 | strata_2)
## Data: mydata
## 
##       AIC       BIC    logLik  deviance  df.resid 
##  490939.7  490962.0 -245467.9  490935.7    502459 
## 
## Random effects:
## 
## Conditional model:
##  Groups   Name        Variance Std.Dev.
##  strata_2 (Intercept) 0.4638   0.6811  
## Number of obs: 502461, groups:  strata_2, 48
## 
## Conditional model:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -1.7295     0.1018  -16.99   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="more-complexe-example---binary-outcome.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the variances:</span></span>
<span id="cb54-2"><a href="more-complexe-example---binary-outcome.html#cb54-2" aria-hidden="true" tabindex="-1"></a>v_null <span class="ot">&lt;-</span> <span class="fu">get_variance</span>(m_null)</span>
<span id="cb54-3"><a href="more-complexe-example---binary-outcome.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># between stratas variance:</span></span>
<span id="cb54-4"><a href="more-complexe-example---binary-outcome.html#cb54-4" aria-hidden="true" tabindex="-1"></a>v_null<span class="sc">$</span>var.random</span></code></pre></div>
<pre><code>## [1] 0.4638349</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="more-complexe-example---binary-outcome.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># intraclass correlation </span></span>
<span id="cb56-2"><a href="more-complexe-example---binary-outcome.html#cb56-2" aria-hidden="true" tabindex="-1"></a>ICC_intersect <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">icc</span>(m_null)<span class="sc">$</span>ICC_unadjusted<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb56-3"><a href="more-complexe-example---binary-outcome.html#cb56-3" aria-hidden="true" tabindex="-1"></a>ICC_intersect</span></code></pre></div>
<pre><code>## [1] 12.36</code></pre>
<p>Plot of the predicted values by strata:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="more-complexe-example---binary-outcome.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb58-2"><a href="more-complexe-example---binary-outcome.html#cb58-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict_response</span>(</span>
<span id="cb58-3"><a href="more-complexe-example---binary-outcome.html#cb58-3" aria-hidden="true" tabindex="-1"></a>      m_null,</span>
<span id="cb58-4"><a href="more-complexe-example---binary-outcome.html#cb58-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">&quot;strata_2&quot;</span>),</span>
<span id="cb58-5"><a href="more-complexe-example---binary-outcome.html#cb58-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">&quot;random&quot;</span>) </span>
<span id="cb58-6"><a href="more-complexe-example---binary-outcome.html#cb58-6" aria-hidden="true" tabindex="-1"></a>    predictions <span class="ot">&lt;-</span> predictions <span class="sc">%&gt;%</span> </span>
<span id="cb58-7"><a href="more-complexe-example---binary-outcome.html#cb58-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(predicted) </span>
<span id="cb58-8"><a href="more-complexe-example---binary-outcome.html#cb58-8" aria-hidden="true" tabindex="-1"></a>    predictions<span class="sc">$</span>rown <span class="ot">=</span> <span class="fu">rownames</span>(predictions)</span>
<span id="cb58-9"><a href="more-complexe-example---binary-outcome.html#cb58-9" aria-hidden="true" tabindex="-1"></a>    predictions<span class="sc">$</span>x_lab <span class="ot">&lt;-</span> <span class="fu">paste0</span>(predictions<span class="sc">$</span>rown,<span class="st">&quot;.&quot;</span>,predictions<span class="sc">$</span>x)</span>
<span id="cb58-10"><a href="more-complexe-example---binary-outcome.html#cb58-10" aria-hidden="true" tabindex="-1"></a>    predictions<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;Men&quot;</span>, predictions<span class="sc">$</span>x), <span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>))</span>
<span id="cb58-11"><a href="more-complexe-example---binary-outcome.html#cb58-11" aria-hidden="true" tabindex="-1"></a>    predictions<span class="sc">$</span>ethnicity <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;Non White&quot;</span>, predictions<span class="sc">$</span>x), <span class="st">&quot;Non white&quot;</span>, <span class="st">&quot;White&quot;</span>))</span>
<span id="cb58-12"><a href="more-complexe-example---binary-outcome.html#cb58-12" aria-hidden="true" tabindex="-1"></a>    predictions<span class="sc">$</span>age <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;61+&quot;</span>, df<span class="sc">$</span>x), <span class="st">&quot;61+&quot;</span>,</span>
<span id="cb58-13"><a href="more-complexe-example---binary-outcome.html#cb58-13" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;-50&quot;</span>, df<span class="sc">$</span>x), <span class="st">&quot;-50&quot;</span>,<span class="st">&quot;51-60&quot;</span>)))</span>
<span id="cb58-14"><a href="more-complexe-example---binary-outcome.html#cb58-14" aria-hidden="true" tabindex="-1"></a>    predictions<span class="sc">$</span>Education <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;Short&quot;</span>, predictions<span class="sc">$</span>x), <span class="st">&quot;Short&quot;</span>, <span class="st">&quot;Long&quot;</span>))</span>
<span id="cb58-15"><a href="more-complexe-example---binary-outcome.html#cb58-15" aria-hidden="true" tabindex="-1"></a>    predictions<span class="sc">$</span>localarea <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;Urban&quot;</span>, predictions<span class="sc">$</span>x), <span class="st">&quot;Urban&quot;</span>, <span class="st">&quot;Rural&quot;</span>))</span>
<span id="cb58-16"><a href="more-complexe-example---binary-outcome.html#cb58-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">jpeg</span>(<span class="st">&quot;img/plot_2.jpeg&quot;</span>,</span>
<span id="cb58-17"><a href="more-complexe-example---binary-outcome.html#cb58-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="st">&quot;500&quot;</span>)</span>
<span id="cb58-18"><a href="more-complexe-example---binary-outcome.html#cb58-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(predictions <span class="sc">%&gt;%</span> </span>
<span id="cb58-19"><a href="more-complexe-example---binary-outcome.html#cb58-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>predicted, <span class="at">y=</span><span class="fu">fct_reorder</span>(x,predicted,<span class="at">.fun=</span><span class="st">&#39;median&#39;</span>), </span>
<span id="cb58-20"><a href="more-complexe-example---binary-outcome.html#cb58-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> sex, <span class="at">linetype =</span> ethnicity))<span class="sc">+</span></span>
<span id="cb58-21"><a href="more-complexe-example---binary-outcome.html#cb58-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> Education, <span class="at">alpha =</span> localarea),<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb58-22"><a href="more-complexe-example---binary-outcome.html#cb58-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> conf.low, <span class="at">xmax =</span> conf.high, <span class="at">size =</span> age)) <span class="sc">+</span></span>
<span id="cb58-23"><a href="more-complexe-example---binary-outcome.html#cb58-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Sratas&quot;</span>,</span>
<span id="cb58-24"><a href="more-complexe-example---binary-outcome.html#cb58-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb58-25"><a href="more-complexe-example---binary-outcome.html#cb58-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> <span class="st">&quot;Education&quot;</span>,</span>
<span id="cb58-26"><a href="more-complexe-example---binary-outcome.html#cb58-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="st">&quot;Life place&quot;</span>,</span>
<span id="cb58-27"><a href="more-complexe-example---binary-outcome.html#cb58-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="st">&quot;Age class&quot;</span>,</span>
<span id="cb58-28"><a href="more-complexe-example---binary-outcome.html#cb58-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;Sex category&quot;</span>,</span>
<span id="cb58-29"><a href="more-complexe-example---binary-outcome.html#cb58-29" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linetype =</span> <span class="st">&quot;Ethnicity&quot;</span>,</span>
<span id="cb58-30"><a href="more-complexe-example---binary-outcome.html#cb58-30" aria-hidden="true" tabindex="-1"></a>                 <span class="at">title =</span> <span class="st">&quot;Predicted values for daily alcohol consumption&quot;</span>) <span class="sc">+</span></span>
<span id="cb58-31"><a href="more-complexe-example---binary-outcome.html#cb58-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb58-32"><a href="more-complexe-example---binary-outcome.html#cb58-32" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_size_discrete</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb58-33"><a href="more-complexe-example---binary-outcome.html#cb58-33" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_alpha_discrete</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>)))</span>
<span id="cb58-34"><a href="more-complexe-example---binary-outcome.html#cb58-34" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>## png 
##   2</code></pre>
<p><img src="img/plot_2.jpeg" /></p>
</div>
<div id="the-variance-change-2" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> The variance change<a href="more-complexe-example---binary-outcome.html#the-variance-change-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To calculate the (additive) contribution of each category to the total variance, we can estimate the variance change when adjusting for this category. The Proportional Variance Change (PVC) when adjusting for all categories is the portion of ICC/VPC explained by additive effect. Therefore 100% - PVC is the part explained by an intersectional effect .</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="more-complexe-example---binary-outcome.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># models where we add each category one by one</span></span>
<span id="cb60-2"><a href="more-complexe-example---binary-outcome.html#cb60-2" aria-hidden="true" tabindex="-1"></a>m_gender <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(AlcDaily <span class="sc">~</span> Sex <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> strata_2),</span>
<span id="cb60-3"><a href="more-complexe-example---binary-outcome.html#cb60-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> mydata, <span class="at">family=</span>binomial)</span>
<span id="cb60-4"><a href="more-complexe-example---binary-outcome.html#cb60-4" aria-hidden="true" tabindex="-1"></a>m_ethnicity <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(AlcDaily <span class="sc">~</span> Ethnicity <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> strata_2),</span>
<span id="cb60-5"><a href="more-complexe-example---binary-outcome.html#cb60-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> mydata, <span class="at">family=</span>binomial)</span>
<span id="cb60-6"><a href="more-complexe-example---binary-outcome.html#cb60-6" aria-hidden="true" tabindex="-1"></a>m_age <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(AlcDaily <span class="sc">~</span> Age_class <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> strata_2),</span>
<span id="cb60-7"><a href="more-complexe-example---binary-outcome.html#cb60-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> mydata, <span class="at">family=</span>binomial)</span>
<span id="cb60-8"><a href="more-complexe-example---binary-outcome.html#cb60-8" aria-hidden="true" tabindex="-1"></a>m_urban <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(AlcDaily <span class="sc">~</span> Urban <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> strata_2),</span>
<span id="cb60-9"><a href="more-complexe-example---binary-outcome.html#cb60-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> mydata, <span class="at">family=</span>binomial)</span>
<span id="cb60-10"><a href="more-complexe-example---binary-outcome.html#cb60-10" aria-hidden="true" tabindex="-1"></a>m_qualif <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(AlcDaily <span class="sc">~</span> Education <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> strata_2),</span>
<span id="cb60-11"><a href="more-complexe-example---binary-outcome.html#cb60-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> mydata, <span class="at">family=</span>binomial)</span>
<span id="cb60-12"><a href="more-complexe-example---binary-outcome.html#cb60-12" aria-hidden="true" tabindex="-1"></a>m_full <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(AlcDaily <span class="sc">~</span> Age_class <span class="sc">+</span> Ethnicity <span class="sc">+</span> Sex <span class="sc">+</span></span>
<span id="cb60-13"><a href="more-complexe-example---binary-outcome.html#cb60-13" aria-hidden="true" tabindex="-1"></a>                    Urban <span class="sc">+</span> Education <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">|</span> strata_2),</span>
<span id="cb60-14"><a href="more-complexe-example---binary-outcome.html#cb60-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> mydata, <span class="at">family=</span>binomial)</span>
<span id="cb60-15"><a href="more-complexe-example---binary-outcome.html#cb60-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-16"><a href="more-complexe-example---binary-outcome.html#cb60-16" aria-hidden="true" tabindex="-1"></a>v_gender <span class="ot">&lt;-</span> <span class="fu">get_variance</span>(m_gender)</span>
<span id="cb60-17"><a href="more-complexe-example---binary-outcome.html#cb60-17" aria-hidden="true" tabindex="-1"></a>v_ethnicity <span class="ot">&lt;-</span> <span class="fu">get_variance</span>(m_ethnicity)</span>
<span id="cb60-18"><a href="more-complexe-example---binary-outcome.html#cb60-18" aria-hidden="true" tabindex="-1"></a>v_age <span class="ot">&lt;-</span> <span class="fu">get_variance</span>(m_age)</span>
<span id="cb60-19"><a href="more-complexe-example---binary-outcome.html#cb60-19" aria-hidden="true" tabindex="-1"></a>v_urban <span class="ot">&lt;-</span> <span class="fu">get_variance</span>(m_urban)</span>
<span id="cb60-20"><a href="more-complexe-example---binary-outcome.html#cb60-20" aria-hidden="true" tabindex="-1"></a>v_qualif <span class="ot">&lt;-</span> <span class="fu">get_variance</span>(m_qualif)</span>
<span id="cb60-21"><a href="more-complexe-example---binary-outcome.html#cb60-21" aria-hidden="true" tabindex="-1"></a>v_full <span class="ot">&lt;-</span> <span class="fu">get_variance</span>(m_full)</span>
<span id="cb60-22"><a href="more-complexe-example---binary-outcome.html#cb60-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-23"><a href="more-complexe-example---binary-outcome.html#cb60-23" aria-hidden="true" tabindex="-1"></a>prop_gender <span class="ot">&lt;-</span> <span class="fu">round</span>(((v_null<span class="sc">$</span>var.random <span class="sc">-</span> v_gender<span class="sc">$</span>var.random) <span class="sc">/</span> v_null<span class="sc">$</span>var.random)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb60-24"><a href="more-complexe-example---binary-outcome.html#cb60-24" aria-hidden="true" tabindex="-1"></a>prop_gender <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(prop_gender), <span class="dv">0</span>, prop_gender)</span>
<span id="cb60-25"><a href="more-complexe-example---binary-outcome.html#cb60-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-26"><a href="more-complexe-example---binary-outcome.html#cb60-26" aria-hidden="true" tabindex="-1"></a>prop_ethnicity <span class="ot">&lt;-</span> <span class="fu">round</span>(((v_null<span class="sc">$</span>var.random <span class="sc">-</span> v_ethnicity<span class="sc">$</span>var.random) <span class="sc">/</span> v_null<span class="sc">$</span>var.random)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb60-27"><a href="more-complexe-example---binary-outcome.html#cb60-27" aria-hidden="true" tabindex="-1"></a>prop_ethnicity <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(prop_ethnicity), <span class="dv">0</span>, prop_ethnicity)</span>
<span id="cb60-28"><a href="more-complexe-example---binary-outcome.html#cb60-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-29"><a href="more-complexe-example---binary-outcome.html#cb60-29" aria-hidden="true" tabindex="-1"></a>prop_age <span class="ot">&lt;-</span> <span class="fu">round</span>(((v_null<span class="sc">$</span>var.random <span class="sc">-</span> v_age<span class="sc">$</span>var.random) <span class="sc">/</span> v_null<span class="sc">$</span>var.random)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb60-30"><a href="more-complexe-example---binary-outcome.html#cb60-30" aria-hidden="true" tabindex="-1"></a>prop_age <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(prop_age), <span class="dv">0</span>, prop_age)</span>
<span id="cb60-31"><a href="more-complexe-example---binary-outcome.html#cb60-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-32"><a href="more-complexe-example---binary-outcome.html#cb60-32" aria-hidden="true" tabindex="-1"></a>prop_qualif <span class="ot">&lt;-</span> <span class="fu">round</span>(((v_null<span class="sc">$</span>var.random <span class="sc">-</span> v_qualif<span class="sc">$</span>var.random) <span class="sc">/</span> v_null<span class="sc">$</span>var.random)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb60-33"><a href="more-complexe-example---binary-outcome.html#cb60-33" aria-hidden="true" tabindex="-1"></a>prop_qualif <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(prop_qualif), <span class="dv">0</span>, prop_qualif)</span>
<span id="cb60-34"><a href="more-complexe-example---binary-outcome.html#cb60-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-35"><a href="more-complexe-example---binary-outcome.html#cb60-35" aria-hidden="true" tabindex="-1"></a>prop_urban <span class="ot">&lt;-</span> <span class="fu">round</span>(((v_null<span class="sc">$</span>var.random <span class="sc">-</span> v_urban<span class="sc">$</span>var.random) <span class="sc">/</span> v_null<span class="sc">$</span>var.random)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb60-36"><a href="more-complexe-example---binary-outcome.html#cb60-36" aria-hidden="true" tabindex="-1"></a>prop_urban <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(prop_urban), <span class="dv">0</span>, prop_urban)</span>
<span id="cb60-37"><a href="more-complexe-example---binary-outcome.html#cb60-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-38"><a href="more-complexe-example---binary-outcome.html#cb60-38" aria-hidden="true" tabindex="-1"></a>prop_full <span class="ot">&lt;-</span> <span class="fu">round</span>(((v_null<span class="sc">$</span>var.random <span class="sc">-</span> v_full<span class="sc">$</span>var.random) <span class="sc">/</span> v_null<span class="sc">$</span>var.random)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb60-39"><a href="more-complexe-example---binary-outcome.html#cb60-39" aria-hidden="true" tabindex="-1"></a>prop_full <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(prop_full), <span class="dv">100</span>, prop_full)</span>
<span id="cb60-40"><a href="more-complexe-example---binary-outcome.html#cb60-40" aria-hidden="true" tabindex="-1"></a>prop_intersection <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">-</span> prop_full,<span class="dv">2</span>)</span>
<span id="cb60-41"><a href="more-complexe-example---binary-outcome.html#cb60-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-42"><a href="more-complexe-example---binary-outcome.html#cb60-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-43"><a href="more-complexe-example---binary-outcome.html#cb60-43" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(</span>
<span id="cb60-44"><a href="more-complexe-example---binary-outcome.html#cb60-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb60-45"><a href="more-complexe-example---binary-outcome.html#cb60-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind</span>(</span>
<span id="cb60-46"><a href="more-complexe-example---binary-outcome.html#cb60-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameters =</span> <span class="fu">c</span>(<span class="st">&quot;ICC/VPC&quot;</span>, <span class="st">&quot;% Sex category&quot;</span>, <span class="st">&quot;% Age/generation&quot;</span>,</span>
<span id="cb60-47"><a href="more-complexe-example---binary-outcome.html#cb60-47" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;% Ethnicity&quot;</span>, <span class="st">&quot;% Life Place&quot;</span>, <span class="st">&quot;% Education&quot;</span>,</span>
<span id="cb60-48"><a href="more-complexe-example---binary-outcome.html#cb60-48" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;%Intersection&quot;</span>),</span>
<span id="cb60-49"><a href="more-complexe-example---binary-outcome.html#cb60-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(ICC_intersect,prop_gender, prop_age, prop_ethnicity,</span>
<span id="cb60-50"><a href="more-complexe-example---binary-outcome.html#cb60-50" aria-hidden="true" tabindex="-1"></a>               prop_urban,prop_qualif, prop_intersection )</span>
<span id="cb60-51"><a href="more-complexe-example---binary-outcome.html#cb60-51" aria-hidden="true" tabindex="-1"></a>  )))</span></code></pre></div>
<pre><code>##         parameters values
## 1          ICC/VPC  12.36
## 2   % Sex category  20.07
## 3 % Age/generation   6.62
## 4      % Ethnicity  55.45
## 5     % Life Place  15.46
## 6      % Education    2.3
## 7    %Intersection   5.02</code></pre>
<p>ICC is 12.36%, which is low. This differences is mainly explained by ethnicity (55.45%), sex category (20.07%) and life place (15.46%).</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simple-example---continous-outcome.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="more-complexe-example---quantitative-outcome.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
